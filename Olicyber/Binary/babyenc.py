target = bytearray([0x27, 0x2d, 0x20, 0x26, 0x3a, 0x36, 0x29, 0x70, 0x2d, 0x72, 0x70, 0x1e, 0x39, 0x71, 0x33, 0x3c])
key = bytearray([0xf8, 0x6f, 0x86, 0x83, 0xc3, 0x9c, 0x8b, 0x35, 0xf0, 0xc0, 0x87, 0x92, 0x2e, 0x41, 0x2b, 0x53])

def rotate_key(key):
    return bytes([key[-1]]) + key[:-1]

def main(target, key):

    for _ in range(16):  
        key = rotate_key(key)

    for i in range(16): 
        for j in range(16):
            target[j] ^= key[j] 
        key = rotate_key(key) 
    return target

if __name__ == "__main__":
    flag = main(target, key)
    print("flag:", flag.decode())
